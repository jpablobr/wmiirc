import:
  - control/mouse.yaml
  - display/barlet.yaml

script:
  before:
    - |
      class TagBarlet < Barlet
        def initialize tag
          super tag, :left
          self.label = tag
        end
      end

  after:
    - |
      # create buttons for tags in /lbar
      fs.lbar.clear
      tags.each {|t| event 'CreateTag', t }
      event 'FocusTag', curr_tag # rescue nil

control:
  event:
    CreateTag: |
      lbar = Rumai.fs.lbar
      p lbar: lbar
      p exist: lbar.exist?
      p entries: lbar.entries
      test = lbar.testing123
      p test: test
      p exist: test.exist?
      p create: test.create
      p exist: test.exist?
      p write: test.write("label testing 123")
      p remove: test.remove
      p exist: test.exist?
      TagBarlet.new(argv[0]) # rescue nil

    DestroyTag: |
      TagBarlet.new(argv[0]).remove

    FocusTag: |
      TagBarlet.new(argv[0]).colors = 'focus'

    UnfocusTag: |
      TagBarlet.new(argv[0]).colors = 'normal'

    UrgentTag: |
      tag = argv[1]
      TagBarlet.new(tag).colors = 'notice'

    NotUrgentTag: |
      tag = argv[1]
      TagBarlet.new(tag).colors = (curr_view.id == tag) ? 'focus' : 'normal'

    LeftBarClick: &LeftBarClick |
      mouse_code, view_id = argv
      mouse_event = Mouse[mouse_code]

      case mouse_event
      when 'left_click'
        focus_view view_id

      when 'wheel_click'
        curr_client.tag view_id

      when 'right_click'
        curr_client.untag view_id
      end

    ##
    # allows the user to drag a file over a
    # view button and activate that view while
    # still holding on to their dragged file!
    #
    LeftBarDND: *LeftBarClick
